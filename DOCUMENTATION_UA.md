# üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è Backend - –ü—Ä–æ–µ–∫—Ç Handyman (Mr. Fixter / Profixter)

## üìã –ó–º—ñ—Å—Ç
1. [–ó–∞–≥–∞–ª—å–Ω–∏–π –æ–≥–ª—è–¥](#–∑–∞–≥–∞–ª—å–Ω–∏–π-–æ–≥–ª—è–¥)
2. [–ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É](#–∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç—É)
3. [–¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—á–Ω–∏–π —Å—Ç–µ–∫](#—Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—á–Ω–∏–π-—Å—Ç–µ–∫)
4. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª—ñ–≤](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-—Ñ–∞–π–ª—ñ–≤)
5. [–ú–æ–¥–µ–ª—ñ –¥–∞–Ω–∏—Ö](#–º–æ–¥–µ–ª—ñ-–¥–∞–Ω–∏—Ö)
6. [API –º–∞—Ä—à—Ä—É—Ç–∏](#api-–º–∞—Ä—à—Ä—É—Ç–∏)
7. [Middleware](#middleware)
8. [–£—Ç–∏–ª—ñ—Ç–∏](#—É—Ç–∏–ª—ñ—Ç–∏)
9. [–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è (CRON)](#–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è-cron)
10. [–Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó](#—ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó)
11. [–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ –∑–º—ñ–Ω–Ω—ñ –æ—Ç–æ—á–µ–Ω–Ω—è](#–Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è-—Ç–∞-–∑–º—ñ–Ω–Ω—ñ-–æ—Ç–æ—á–µ–Ω–Ω—è)

---

## üéØ –ó–∞–≥–∞–ª—å–Ω–∏–π –æ–≥–ª—è–¥

–¶–µ backend –¥–æ–¥–∞—Ç–æ–∫ –¥–ª—è —Å–µ—Ä–≤—ñ—Å—É **Mr. Fixter (Profixter)** - –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏ –¥–ª—è –Ω–µ–æ–±–º–µ–∂–µ–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É –¥–æ –ø–æ—Å–ª—É–≥ –º–∞–π—Å—Ç—Ä—ñ–≤ –Ω–∞ Long Island, NY (–æ–∫—Ä—É–≥–∏ Nassau —Ç–∞ Suffolk).

### –û—Å–Ω–æ–≤–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó:
- ‚úÖ –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è —Ç–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- ÔøΩ –í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è —á–µ—Ä–µ–∑ OTP –∫–æ–¥ (6-–∑–Ω–∞—á–Ω–∏–π, 5 —Ö–≤–∏–ª–∏–Ω)
- ÔøΩüìÖ –°–∏—Å—Ç–µ–º–∞ –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è –∑ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º —Ç–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è–º —Å–ª–æ—Ç–∞–º–∏
- üí≥ –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑—ñ Stripe –¥–ª—è –ø—ñ–¥–ø–∏—Å–æ–∫ —Ç–∞ –ø–ª–∞—Ç–µ–∂—ñ–≤
- ü§ñ AI —á–∞—Ç–±–æ—Ç (OpenAI GPT-4) –¥–ª—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ–π
- üìß Email —Å–µ—Ä–≤—ñ—Å (AWS SES) –¥–ª—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π–Ω–∏—Ö –ª–∏—Å—Ç—ñ–≤
- üë• –°–∏—Å—Ç–µ–º–∞ —Ä–µ—Ñ–µ—Ä–∞–ª—ñ–≤
- üìä –ê–¥–º—ñ–Ω –ø–∞–Ω–µ–ª—å –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è
- üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ –Ω–∞–≥–∞–¥—É–≤–∞–Ω–Ω—è —Ç–∞ follow-up emails
- üåç –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –º–Ω–æ–∂–∏–Ω–Ω–∏—Ö –∞–¥—Ä–µ—Å –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

---

## üèó –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É

### –¢–∏–ø: –ú–æ–Ω–æ–ª—ñ—Ç–Ω–∏–π REST API —Å–µ—Ä–≤–µ—Ä
- **Framework**: Express.js (Node.js)
- **–ë–∞–∑–∞ –¥–∞–Ω–∏—Ö**: MongoDB (—á–µ—Ä–µ–∑ Mongoose ODM)
- **Hosting**: AWS Elastic Beanstalk (–∑–≥—ñ–¥–Ω–æ –∑ Procfile)
- **Storage**: AWS S3 –¥–ª—è —Ñ–∞–π–ª—ñ–≤ (–∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –¥–æ –±—Ä–æ–Ω—é–≤–∞–Ω—å)

### –ö–ª—é—á–æ–≤—ñ –ø–∞—Ç–µ—Ä–Ω–∏:
- MVC (Model-View-Controller) –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞
- Middleware –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Ç–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó
- RESTful API endpoints
- JWT —Ç–æ–∫–µ–Ω–∏ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó
- Webhook-based —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó (Stripe)

---

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—á–Ω–∏–π —Å—Ç–µ–∫

### –û—Å–Ω–æ–≤–Ω—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ:
```json
{
  "express": "^4.18.2",           // Web —Ñ—Ä–µ–π–º–≤–æ—Ä–∫
  "mongoose": "^7.8.6",           // MongoDB ODM
  "bcryptjs": "^3.0.2",           // –•–µ—à—É–≤–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—ñ–≤
  "jsonwebtoken": "^9.0.2",       // JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è
  "stripe": "^17.7.0",            // –ü–ª–∞—Ç—ñ–∂–Ω–∞ —Å–∏—Å—Ç–µ–º–∞
  "nodemailer": "^6.10.1",        // Email –≤—ñ–¥–ø—Ä–∞–≤–∫–∞
  "@aws-sdk/client-s3": "^3.876", // AWS S3 –¥–ª—è —Ñ–∞–π–ª—ñ–≤
  "multer": "^1.4.5-lts.2",       // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤
  "node-cron": "^4.2.1",          // CRON –∑–∞–¥–∞—á—ñ
  "moment-timezone": "^0.6.0",    // –†–æ–±–æ—Ç–∞ –∑ —á–∞—Å–æ–≤–∏–º–∏ –∑–æ–Ω–∞–º–∏
  "cors": "^2.8.5",               // CORS middleware
  "dotenv": "^16.4.7"             // –ó–º—ñ–Ω–Ω—ñ –æ—Ç–æ—á–µ–Ω–Ω—è
}
```

### Node.js –≤–µ—Ä—Å—ñ—è: 18.x

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª—ñ–≤

```
backend/
‚îú‚îÄ‚îÄ server.js                 # –ì–æ–ª–æ–≤–Ω–∏–π —Ñ–∞–π–ª —Å–µ—Ä–≤–µ—Ä–∞
‚îú‚îÄ‚îÄ package.json             # –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –ø—Ä–æ–µ–∫—Ç—É
‚îú‚îÄ‚îÄ Procfile                 # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –¥–ª—è Heroku/AWS EB
‚îÇ
‚îú‚îÄ‚îÄ models/                  # Mongoose —Å—Ö–µ–º–∏ —Ç–∞ –º–æ–¥–µ–ª—ñ
‚îÇ   ‚îú‚îÄ‚îÄ User.js             # –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á
‚îÇ   ‚îú‚îÄ‚îÄ Booking.js          # –ë—Ä–æ–Ω—é–≤–∞–Ω–Ω—è
‚îÇ   ‚îú‚îÄ‚îÄ Subscription.js     # –ü—ñ–¥–ø–∏—Å–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ Lead.js             # –õ—ñ–¥–∏ (–ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω—ñ –∫–ª—ñ—î–Ω—Ç–∏)
‚îÇ   ‚îú‚îÄ‚îÄ Conversation.js     # –Ü—Å—Ç–æ—Ä—ñ—è —á–∞—Ç—É
‚îÇ   ‚îú‚îÄ‚îÄ Referral.js         # –†–µ—Ñ–µ—Ä–∞–ª—å–Ω—ñ –∑–∞–ø—Ä–æ—à–µ–Ω–Ω—è
‚îÇ   ‚îú‚îÄ‚îÄ CalendarConfig.js   # –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è
‚îÇ   ‚îú‚îÄ‚îÄ SlotCounter.js      # –õ—ñ—á–∏–ª—å–Ω–∏–∫ –¥–æ—Å—Ç—É–ø–Ω–∏—Ö —Å–ª–æ—Ç—ñ–≤
‚îÇ   ‚îú‚îÄ‚îÄ Otp.js              # OTP –∫–æ–¥–∏
‚îÇ   ‚îú‚îÄ‚îÄ Blacklist.js        # –ß–æ—Ä–Ω–∏–π —Å–ø–∏—Å–æ–∫
‚îÇ   ‚îî‚îÄ‚îÄ Request.js          # –ó–∞–ø–∏—Ç–∏ –∫–ª—ñ—î–Ω—Ç—ñ–≤
‚îÇ
‚îú‚îÄ‚îÄ routes/                 # API –º–∞—Ä—à—Ä—É—Ç–∏ (endpoints)
‚îÇ   ‚îú‚îÄ‚îÄ auth.js            # –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è —Ç–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—è
‚îÇ   ‚îú‚îÄ‚îÄ users.js           # –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ bookings.js        # CRUD –¥–ª—è –±—Ä–æ–Ω—é–≤–∞–Ω—å
‚îÇ   ‚îú‚îÄ‚îÄ subscriptions.js   # –ü—ñ–¥–ø–∏—Å–∫–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
‚îÇ   ‚îú‚îÄ‚îÄ stripe.js          # Stripe checkout —Å–µ—Å—ñ—ó
‚îÇ   ‚îú‚îÄ‚îÄ webhook.js         # Stripe webhooks
‚îÇ   ‚îú‚îÄ‚îÄ chatbot.js         # AI —á–∞—Ç–±–æ—Ç
‚îÇ   ‚îú‚îÄ‚îÄ calendar.js        # –ö–∞–ª–µ–Ω–¥–∞—Ä —Ç–∞ —Å–ª–æ—Ç–∏
‚îÇ   ‚îú‚îÄ‚îÄ adminCalendar.js   # –ê–¥–º—ñ–Ω —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º
‚îÇ   ‚îú‚îÄ‚îÄ admin.js           # –ê–¥–º—ñ–Ω –ø–∞–Ω–µ–ª—å
‚îÇ   ‚îú‚îÄ‚îÄ referrals.js       # –°–∏—Å—Ç–µ–º–∞ —Ä–µ—Ñ–µ—Ä–∞–ª—ñ–≤
‚îÇ   ‚îú‚îÄ‚îÄ feedback.js        # –í—ñ–¥–≥—É–∫–∏ –∫–ª—ñ—î–Ω—Ç—ñ–≤
‚îÇ   ‚îú‚îÄ‚îÄ facebook.js        # Facebook —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó
‚îÇ   ‚îú‚îÄ‚îÄ track.js           # –¢—Ä–µ–∫—ñ–Ω–≥ –ø–æ–¥—ñ–π
‚îÇ   ‚îú‚îÄ‚îÄ passwordReset.js   # –°–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è
‚îÇ   ‚îú‚îÄ‚îÄ requests.js        # –ó–∞–ø–∏—Ç–∏ –Ω–∞ –ø–æ—Å–ª—É–≥–∏
‚îÇ   ‚îî‚îÄ‚îÄ test.js            # –¢–µ—Å—Ç–æ–≤—ñ endpoints
‚îÇ
‚îú‚îÄ‚îÄ middleware/            # Middleware —Ñ—É–Ω–∫—Ü—ñ—ó
‚îÇ   ‚îú‚îÄ‚îÄ auth.js           # JWT –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ blacklist.js      # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–æ—Ä–Ω–æ–≥–æ —Å–ø–∏—Å–∫—É
‚îÇ   ‚îî‚îÄ‚îÄ otpRateLimit.js   # Rate limiting –¥–ª—è OTP
‚îÇ
‚îú‚îÄ‚îÄ controllers/          # –ö–æ–Ω—Ç—Ä–æ–ª–µ—Ä–∏ –±—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ facebookCapi.js  # Facebook Conversion API
‚îÇ
‚îú‚îÄ‚îÄ utils/               # –£—Ç–∏–ª—ñ—Ç–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó
‚îÇ   ‚îú‚îÄ‚îÄ emailService.js  # –í—ñ–¥–ø—Ä–∞–≤–∫–∞ email —á–µ—Ä–µ–∑ AWS SES
‚îÇ   ‚îú‚îÄ‚îÄ s3.js           # –†–æ–±–æ—Ç–∞ –∑ AWS S3
‚îÇ   ‚îî‚îÄ‚îÄ getNextAvailableSlot.js  # –õ–æ–≥—ñ–∫–∞ –≤—ñ–ª—å–Ω–∏—Ö —Å–ª–æ—Ç—ñ–≤
‚îÇ
‚îú‚îÄ‚îÄ data/               # –°—Ç–∞—Ç–∏—á–Ω—ñ –¥–∞–Ω—ñ
‚îÇ   ‚îî‚îÄ‚îÄ chatbotKnowledge.js  # –ë–∞–∑–∞ –∑–Ω–∞–Ω—å –¥–ª—è —á–∞—Ç–±–æ—Ç–∞
‚îÇ
‚îú‚îÄ‚îÄ scripts/           # –ú—ñ–≥—Ä–∞—Ü—ñ–π–Ω—ñ —Å–∫—Ä–∏–ø—Ç–∏
‚îÇ   ‚îú‚îÄ‚îÄ migrate_addresses.js
‚îÇ   ‚îú‚îÄ‚îÄ backfill_subscription_address.js
‚îÇ   ‚îú‚îÄ‚îÄ ensure_primary_and_link_subs.js
‚îÇ   ‚îî‚îÄ‚îÄ migrate_legacy_subs_to_address.js
‚îÇ
‚îú‚îÄ‚îÄ nudge_lead_v1.json  # Email —à–∞–±–ª–æ–Ω (follow-up 1)
‚îî‚îÄ‚îÄ nudge_lead_v2.json  # Email —à–∞–±–ª–æ–Ω (follow-up 2)
```

---

## üóÉ –ú–æ–¥–µ–ª—ñ –¥–∞–Ω–∏—Ö

### 1. **User** (`models/User.js`)
–ì–æ–ª–æ–≤–Ω–∞ –º–æ–¥–µ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Å–∏—Å—Ç–µ–º–∏.

**–ü–æ–ª—è:**
- `userId` (String, unique) - 8-–∑–Ω–∞—á–Ω–∏–π –ø—É–±–ª—ñ—á–Ω–∏–π ID
- `name` (String) - –Ü–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- `email` (String, unique, lowercase) - Email
- `password` (String) - –•–µ—à–æ–≤–∞–Ω–∏–π –ø–∞—Ä–æ–ª—å (bcrypt)
- `phone` (String) - –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É
- `stripeCustomerId` (String) - ID –∫–ª—ñ—î–Ω—Ç–∞ –≤ Stripe

**–ê–¥—Ä–µ—Å–∏ (–º–Ω–æ–∂–∏–Ω–Ω—ñ):**
- `addresses` (Array) - –ú–∞—Å–∏–≤ –∞–¥—Ä–µ—Å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
  - `label` - –ù–∞–∑–≤–∞ (–Ω–∞–ø—Ä. "Primary", "Summer House")
  - `line1` - –ê–¥—Ä–µ—Å–∞
  - `city` - –ú—ñ—Å—Ç–æ
  - `state` - –®—Ç–∞—Ç (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º "NY")
  - `zip` - –ü–æ—à—Ç–æ–≤–∏–π —ñ–Ω–¥–µ–∫—Å
  - `county` - –û–∫—Ä—É–≥ (Nassau –∞–±–æ Suffolk)
- `defaultAddressId` (ObjectId) - ID –∞–¥—Ä–µ—Å–∏ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º

**Legacy –ø–æ–ª—è (—Å—É–º—ñ—Å–Ω—ñ—Å—Ç—å):**
- `address`, `city`, `state`, `zip`, `county` - –°—Ç–∞—Ä–∏–π —Ñ–æ—Ä–º–∞—Ç –∞–¥—Ä–µ—Å–∏
- `subscription` (String) - –¢–∏–ø –ø—ñ–¥–ø–∏—Å–∫–∏ (basic/plus/premium/elite)
- `subscriptionExpiry` (Date) - –î–∞—Ç–∞ –∑–∞–∫—ñ–Ω—á–µ–Ω–Ω—è –ø—ñ–¥–ø–∏—Å–∫–∏
- `subscriptionStart` (Date) - –î–∞—Ç–∞ –ø–æ—á–∞—Ç–∫—É –ø—ñ–¥–ø–∏—Å–∫–∏

---

### 2. **Booking** (`models/Booking.js`)
–ë—Ä–æ–Ω—é–≤–∞–Ω–Ω—è –ø–æ—Å–ª—É–≥ –º–∞–π—Å—Ç—Ä–∞.

**–ü–æ–ª—è:**
- `bookingNumber` (String) - –ù–æ–º–µ—Ä –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è
- `date` (Date) - –î–∞—Ç–∞ —ñ —á–∞—Å –≤—ñ–∑–∏—Ç—É
- `service` (String) - –û–ø–∏—Å –ø–æ—Å–ª—É–≥–∏
- `user` (ObjectId ref User) - –ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- `userId` (String) - –ü—É–±–ª—ñ—á–Ω–∏–π ID –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- `addressId` (ObjectId) - ID –∞–¥—Ä–µ—Å–∏ –¥–ª—è –≤—ñ–∑–∏—Ç—É
- `address`, `city`, `state`, `zip`, `county` - –î–µ—Ç–∞–ª—ñ –∞–¥—Ä–µ—Å–∏
- `phone`, `email`, `name` - –ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è
- `subscription` (String) - –¢–∏–ø –ø—ñ–¥–ø–∏—Å–∫–∏ –Ω–∞ –º–æ–º–µ–Ω—Ç —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è
- `note` (String) - –ü—Ä–∏–º—ñ—Ç–∫–∏ –¥–æ –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è
- `images` (Array) - URLs –∑–æ–±—Ä–∞–∂–µ–Ω—å –ø—Ä–æ–±–ª–µ–º–∏
- `status` (String) - –°—Ç–∞—Ç—É—Å: Pending/Confirmed/Completed/Canceled
- `statusHistory` (Array) - –Ü—Å—Ç–æ—Ä—ñ—è –∑–º—ñ–Ω–∏ —Å—Ç–∞—Ç—É—Å—ñ–≤
- `cancellationReason` (String) - –ü—Ä–∏—á–∏–Ω–∞ —Å–∫–∞—Å—É–≤–∞–Ω–Ω—è
- `feedback` (String) - –í—ñ–¥–≥—É–∫ –ø—ñ—Å–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è
- `assignedHandyman` (String) - –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –º–∞–π—Å—Ç–µ—Ä

**–Ü–Ω–¥–µ–∫—Å–∏:** –ó–∞ user, addressId, date, status –¥–ª—è —à–≤–∏–¥–∫–æ–≥–æ –ø–æ—à—É–∫—É.

---

### 3. **Subscription** (`models/Subscription.js`)
–ü—ñ–¥–ø–∏—Å–∫–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ (–Ω–æ–≤–∞ –º–æ–¥–µ–ª—å –¥–ª—è –º–Ω–æ–∂–∏–Ω–Ω–∏—Ö –∞–¥—Ä–µ—Å).

**–ü–æ–ª—è:**
- `user` (ObjectId ref User) - –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á
- `addressId` (ObjectId) - –ê–¥—Ä–µ—Å–∞, –Ω–∞ —è–∫—É –æ—Ñ–æ—Ä–º–ª–µ–Ω–∞ –ø—ñ–¥–ø–∏—Å–∫–∞
- `subscriptionType` (String) - –¢–∏–ø: basic/plus/premium/elite
- `status` (String) - active/canceled/past_due/trialing
- `stripeSubscriptionId` (String) - ID –ø—ñ–¥–ø–∏—Å–∫–∏ –≤ Stripe
- `stripePriceId` (String) - ID —Ü—ñ–Ω–∏ –≤ Stripe
- `startDate` (Date) - –î–∞—Ç–∞ –ø–æ—á–∞—Ç–∫—É
- `nextPaymentDate` (Date) - –ù–∞—Å—Ç—É–ø–Ω–∏–π –ø–ª–∞—Ç—ñ–∂
- `latestPaymentDate` (Date) - –û—Å—Ç–∞–Ω–Ω—ñ–π –ø–ª–∞—Ç—ñ–∂
- `planPrice` (Number) - –¶—ñ–Ω–∞ –ø–ª–∞–Ω—É

---

### 4. **Lead** (`models/Lead.js`)
–ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω—ñ –∫–ª—ñ—î–Ω—Ç–∏ (–ª—ñ–¥–∏) –∑ —á–∞—Ç–±–æ—Ç–∞ –∞–±–æ —Ñ–æ—Ä–º.

**–ü–æ–ª—è:**
- `name`, `email`, `phone` - –ö–æ–Ω—Ç–∞–∫—Ç–Ω—ñ –¥–∞–Ω—ñ
- `address_line1`, `city`, `state`, `zip`, `county` - –ê–¥—Ä–µ—Å–∞
- `channel` (String) - –ö–∞–Ω–∞–ª: web/messenger/sms
- `source` (String) - –î–∂–µ—Ä–µ–ª–æ: landing page, ad, —Ç–æ—â–æ
- `status` (String enum) - new/engaged/converted/out_of_area/waitlist
- `lastContactAt` (Date) - –û—Å—Ç–∞–Ω–Ω—ñ–π –∫–æ–Ω—Ç–∞–∫—Ç
- `followup1SentAt` (Date) - –ü–µ—Ä—à–∏–π follow-up (~2 –≥–æ–¥–∏–Ω–∏)
- `followup2SentAt` (Date) - –î—Ä—É–≥–∏–π follow-up (~48 –≥–æ–¥–∏–Ω)
- `convertedAt` (Date) - –ö–æ–ª–∏ –∫–æ–Ω–≤–µ—Ä—Ç—É–≤–∞–≤—Å—è –≤ –∫–ª—ñ—î–Ω—Ç–∞
- `tags` (Array) - –¢–µ–≥–∏ –¥–ª—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü—ñ—ó
- `notes` (String) - –ü—Ä–∏–º—ñ—Ç–∫–∏

---

### 5. **Conversation** (`models/Conversation.js`)
–Ü—Å—Ç–æ—Ä—ñ—è —Ä–æ–∑–º–æ–≤ –∑ —á–∞—Ç–±–æ—Ç–æ–º.

**–ü–æ–ª—è:**
- `sessionId` (String) - ID —Å–µ—Å—ñ—ó —á–∞—Ç—É
- `messages` (Array) - –ú–∞—Å–∏–≤ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å {role, content, timestamp}
- `lead` (ObjectId ref Lead) - –ü–æ–≤'—è–∑–∞–Ω–∏–π –ª—ñ–¥

---

### 6. **CalendarConfig** (`models/CalendarConfig.js`)
–ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è –¥–ª—è –±—Ä–æ–Ω—é–≤–∞–Ω—å.

**–ü–æ–ª—è:**
- `date` (String, YYYY-MM-DD) - –î–∞—Ç–∞
- `totalCapacity` (Number) - –ó–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å–ª–æ—Ç—ñ–≤ –Ω–∞ –¥–µ–Ω—å
- `disabled` (Boolean) - –ß–∏ –≤–∏–º–∫–Ω–µ–Ω–∏–π —Ü–µ–π –¥–µ–Ω—å

---

### 7. **SlotCounter** (`models/SlotCounter.js`)
–õ—ñ—á–∏–ª—å–Ω–∏–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏—Ö —Å–ª–æ—Ç—ñ–≤ –Ω–∞ –¥–µ–Ω—å.

**–ü–æ–ª—è:**
- `date` (String, YYYY-MM-DD, unique) - –î–∞—Ç–∞
- `count` (Number) - –ö—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–π–Ω—è—Ç–∏—Ö —Å–ª–æ—Ç—ñ–≤

---

### 8. **Referral** (`models/Referral.js`)
–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞ —Å–∏—Å—Ç–µ–º–∞.

**–ü–æ–ª—è:**
- `referrer` (ObjectId ref User) - –•—Ç–æ –∑–∞–ø—Ä–æ—Å–∏–≤
- `referredEmail` (String) - Email –∑–∞–ø—Ä–æ—à–µ–Ω–æ–≥–æ
- `status` (String) - pending/converted
- `code` (String) - –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∏–π –∫–æ–¥

---

### 9. **Blacklist** (`models/Blacklist.js`)
–ß–æ—Ä–Ω–∏–π —Å–ø–∏—Å–æ–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤.

**–ü–æ–ª—è:**
- `userId` (ObjectId ref User)
- `reason` (String) - –ü—Ä–∏—á–∏–Ω–∞ –±–ª–æ–∫—É–≤–∞–Ω–Ω—è
- `addedAt` (Date)

---

### 10. **Otp** (`models/Otp.js`)
OTP –∫–æ–¥–∏ –¥–ª—è –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è.

**–ü–æ–ª—è:**
- `email` (String, indexed, lowercase) - Email –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- `hash` (String) - Bcrypt hash 6-–∑–Ω–∞—á–Ω–æ–≥–æ OTP –∫–æ–¥—É
- `createdAt` (Date, TTL index) - –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–¥–∞–ª—è—î—Ç—å—Å—è —á–µ—Ä–µ–∑ 5 —Ö–≤–∏–ª–∏–Ω (300 —Å–µ–∫—É–Ω–¥)

**–ë–µ–∑–ø–µ–∫–∞:**
- –ó–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ hash, –Ω–µ —Å–∞–º –∫–æ–¥
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏–¥–∞–ª–µ–Ω–Ω—è —á–µ—Ä–µ–∑ MongoDB TTL index
- –û–¥–Ω–æ—Ä–∞–∑–æ–≤–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è (–≤–∏–¥–∞–ª—è—î—Ç—å—Å—è –ø—ñ—Å–ª—è verify)
- Rate limiting –Ω–∞ —Ä—ñ–≤–Ω—ñ —Ä–æ—É—Ç–∞

---

## üåê API –º–∞—Ä—à—Ä—É—Ç–∏

### üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è (`/api/auth`)

#### POST `/api/auth/register`
–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –Ω–æ–≤–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.
- **Body**: `{ name, email, password, phone, address, city, state, zip, county }`
- **Response**: `{ token, user }`

#### POST `/api/auth/login`
–í—Ö—ñ–¥ –≤ —Å–∏—Å—Ç–µ–º—É.
- **Body**: `{ email, password }`
- **Response**: `{ token, user }`

#### GET `/api/auth/me`
–û—Ç—Ä–∏–º–∞—Ç–∏ –¥–∞–Ω—ñ –ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.
- **Headers**: `Authorization: Bearer <token>`
- **Response**: `{ user, coverage }` - –¥–∞–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ + –ø–æ–∫—Ä–∏—Ç—Ç—è –ø—ñ–¥–ø–∏—Å–æ–∫ –ø–æ –∞–¥—Ä–µ—Å–∞–º

---

### ÔøΩ –í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è (`/api/password-reset`)

–°–∏—Å—Ç–µ–º–∞ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è —á–µ—Ä–µ–∑ OTP –∫–æ–¥ (3-–µ—Ç–∞–ø–Ω–∏–π –ø—Ä–æ—Ü–µ—Å).

#### POST `/api/password-reset`
**–ö—Ä–æ–∫ 1:** –ó–∞–ø—Ä–æ—Å–∏—Ç–∏ OTP –∫–æ–¥ –Ω–∞ email.
- **Body**: `{ email }`
- **Response**: `{ message: "OTP sent" }`
- **–î—ñ—è**: 
  - –ì–µ–Ω–µ—Ä—É—î 6-–∑–Ω–∞—á–Ω–∏–π OTP –∫–æ–¥
  - –í–∏–¥–∞–ª—è—î —Å—Ç–∞—Ä—ñ –∫–æ–¥–∏ –¥–ª—è —Ü—å–æ–≥–æ email
  - –ó–±–µ—Ä—ñ–≥–∞—î bcrypt hash –∫–æ–¥—É –≤ –ë–î (TTL 5 —Ö–≤–∏–ª–∏–Ω)
  - –í—ñ–¥–ø—Ä–∞–≤–ª—è—î –∫–æ–¥ –Ω–∞ email —á–µ—Ä–µ–∑ —à–∞–±–ª–æ–Ω `password_otp`
- **Rate Limiting**: 3 –∑–∞–ø–∏—Ç–∏ –Ω–∞ —Ö–≤–∏–ª–∏–Ω—É –Ω–∞ IP+email

#### POST `/api/password-reset/verify`
**–ö—Ä–æ–∫ 2:** –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ OTP –∫–æ–¥ —Ç–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ reset token.
- **Body**: `{ email, otp }`
- **Response**: `{ message: "OTP verified", token: "<resetToken>" }`
- **–í–∞–ª—ñ–¥–∞—Ü—ñ—è**:
  - –ü–µ—Ä–µ–≤—ñ—Ä—è—î —ñ—Å–Ω—É–≤–∞–Ω–Ω—è OTP –¥–ª—è email
  - –ü–æ—Ä—ñ–≤–Ω—é—î bcrypt hash
  - –ü–µ—Ä–µ–≤—ñ—Ä—è—î —Ç–µ—Ä–º—ñ–Ω –¥—ñ—ó (5 —Ö–≤–∏–ª–∏–Ω)
  - –í–∏–¥–∞–ª—è—î OTP –ø—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ—ó –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ (–æ–¥–Ω–æ—Ä–∞–∑–æ–≤–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è)
- **Token**: JWT –∑ —Å–µ–∫—Ä–µ—Ç–æ–º `JWT_RESET_SECRET`, –¥—ñ–π—Å–Ω–∏–π 15 —Ö–≤–∏–ª–∏–Ω

#### POST `/api/password-reset/set-password`
**–ö—Ä–æ–∫ 3:** –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –Ω–æ–≤–∏–π –ø–∞—Ä–æ–ª—å.
- **Body**: `{ token, password }` –∞–±–æ `{ resetToken, password }`
- **Headers** (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞): `Authorization: Bearer <resetToken>`
- **Query** (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞): `?token=<resetToken>`
- **Response**: `{ message: "Password updated" }`
- **–î—ñ—è**:
  - –í–µ—Ä–∏—Ñ—ñ–∫—É—î reset token
  - –•–µ—à—É—î –Ω–æ–≤–∏–π –ø–∞—Ä–æ–ª—å (bcrypt, 10 rounds)
  - –û–Ω–æ–≤–ª—é—î –ø–∞—Ä–æ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
  - –í—ñ–¥–ø—Ä–∞–≤–ª—è—î –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –Ω–∞ email (`password_changed`)

**–ë–µ–∑–ø–µ–∫–∞:**
- OTP –∫–æ–¥–∏ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —è–∫ bcrypt hash (–Ω–µ plain text)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏–¥–∞–ª–µ–Ω–Ω—è —á–µ—Ä–µ–∑ TTL (MongoDB, 5 —Ö–≤–∏–ª–∏–Ω)
- –û–¥–Ω–æ—Ä–∞–∑–æ–≤–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è OTP
- –û–∫—Ä–µ–º–∏–π JWT —Å–µ–∫—Ä–µ—Ç –¥–ª—è reset —Ç–æ–∫–µ–Ω—ñ–≤
- Rate limiting –Ω–∞ –∑–∞–ø–∏—Ç–∏ OTP
- –ö–æ—Ä–æ—Ç–∫–∏–π —Ç–µ—Ä–º—ñ–Ω –¥—ñ—ó reset —Ç–æ–∫–µ–Ω–∞ (15 —Ö–≤–∏–ª–∏–Ω)

**Email —à–∞–±–ª–æ–Ω–∏:**
- `password_otp` - –õ–∏—Å—Ç –∑ 6-–∑–Ω–∞—á–Ω–∏–º –∫–æ–¥–æ–º
- `password_changed` - –ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –∑–º—ñ–Ω–∏ –ø–∞—Ä–æ–ª—è

---

### ÔøΩüë§ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ (`/api/users`)

#### GET `/api/users/profile`
–ü—Ä–æ—Ñ—ñ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (auth required).
- **Response**: `{ user, addresses, defaultAddressId }`

#### PUT `/api/users/profile`
–û–Ω–æ–≤–∏—Ç–∏ –ø—Ä–æ—Ñ—ñ–ª—å.
- **Body**: `{ name, phone, email }`

#### POST `/api/users/addresses`
–î–æ–¥–∞—Ç–∏ –Ω–æ–≤—É –∞–¥—Ä–µ—Å—É.
- **Body**: `{ label, line1, city, state, zip, county }`

#### PUT `/api/users/addresses/:addressId`
–û–Ω–æ–≤–∏—Ç–∏ –∞–¥—Ä–µ—Å—É.

#### DELETE `/api/users/addresses/:addressId`
–í–∏–¥–∞–ª–∏—Ç–∏ –∞–¥—Ä–µ—Å—É.

#### PUT `/api/users/default-address`
–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∞–¥—Ä–µ—Å—É –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º.
- **Body**: `{ addressId }`

---

### üìÖ –ë—Ä–æ–Ω—é–≤–∞–Ω–Ω—è (`/api/bookings`)

#### GET `/api/bookings/next?addressId=<id>`
–û—Ç—Ä–∏–º–∞—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω–µ –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è –¥–ª—è –∞–¥—Ä–µ—Å–∏.

#### GET `/api/bookings/all?addressId=<id>`
–í—Å—ñ –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è –¥–ª—è –∞–¥—Ä–µ—Å–∏.

#### POST `/api/bookings`
–°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–µ –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è.
- **Body**: `{ date, service, addressId, note, images? }`
- **Middleware**: auth, blacklist check
- **–í–∞–ª—ñ–¥–∞—Ü—ñ—è**: 
  - –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—ó –ø—ñ–¥–ø–∏—Å–∫–∏
  - –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—ó capacity
  - –ú—ñ–Ω—ñ–º—É–º 3 –¥–Ω—ñ –º—ñ–∂ –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è–º–∏ –¥–ª—è —Ç—ñ—î—ó –∂ –∞–¥—Ä–µ—Å–∏

#### PUT `/api/bookings/:id`
–û–Ω–æ–≤–∏—Ç–∏ –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è.

#### DELETE `/api/bookings/:id`
–°–∫–∞—Å—É–≤–∞—Ç–∏ –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è.

#### POST `/api/bookings/upload`
–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –¥–ª—è –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è.
- **Form data**: `files[]` (–¥–æ 10 —Ñ–∞–π–ª—ñ–≤, max 50MB)
- **Response**: `{ urls: [...] }` - URLs –Ω–∞ S3

---

### üí≥ Stripe (`/api/stripe`)

#### POST `/api/stripe/create-checkout-session`
–°—Ç–≤–æ—Ä–∏—Ç–∏ Stripe Checkout —Å–µ—Å—ñ—é –¥–ª—è –ø—ñ–¥–ø–∏—Å–∫–∏.
- **Body**: `{ plan, email, addressId, code? }`
- **Response**: `{ id: sessionId }`

**–ü–ª–∞–Ω–∏:**
- `basic` - $149/–º—ñ—Å
- `plus` - $249/–º—ñ—Å
- `premium` - $349/–º—ñ—Å (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–∏–π)
- `elite` - $499/–º—ñ—Å

**Trial period:** 7 –¥–Ω—ñ–≤ –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ

---

### üîî Webhook (`/api/stripe/webhook`)

#### POST `/api/stripe/webhook`
–û–±—Ä–æ–±–∫–∞ Stripe webhooks.
- **Events**: 
  - `checkout.session.completed` - –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø—ñ–¥–ø–∏—Å–∫–∏
  - `customer.subscription.updated` - –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞—Ç—É—Å—É
  - `customer.subscription.deleted` - –°–∫–∞—Å—É–≤–∞–Ω–Ω—è –ø—ñ–¥–ø–∏—Å–∫–∏
  - `invoice.payment_succeeded` - –£—Å–ø—ñ—à–Ω–∏–π –ø–ª–∞—Ç—ñ–∂
  - `invoice.payment_failed` - –ù–µ–≤–¥–∞–ª–∏–π –ø–ª–∞—Ç—ñ–∂

---

### üìä –ü—ñ–¥–ø–∏—Å–∫–∏ (`/api/subscriptions`)

#### GET `/api/subscriptions/my`
–ú–æ—ó –ø—ñ–¥–ø–∏—Å–∫–∏ (–≤—Å—ñ –∞–¥—Ä–µ—Å–∏).
- **Response**: `[ { _id, addressId, address, subscriptionType, status, ... } ]`

#### POST `/api/subscriptions/cancel`
–°–∫–∞—Å—É–≤–∞—Ç–∏ –ø—ñ–¥–ø–∏—Å–∫—É.
- **Body**: `{ addressId }`
- **Note**: –§–∞–∫—Ç–∏—á–Ω–æ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É, —Ü–µ –¥–ª—è –ª–æ–≥—É–≤–∞–Ω–Ω—è

---

### ü§ñ –ß–∞—Ç–±–æ—Ç (`/api/chatbot`)

#### POST `/api/chatbot/message`
–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —á–∞—Ç–±–æ—Ç—É.
- **Body**: `{ message, sessionId?, lead? }`
- **Response**: `{ reply, sessionId, leadId? }`
- **AI Model**: OpenAI GPT-4o-mini
- **Features**:
  - –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –ø–æ—Å–ª—É–≥–∏ —Ç–∞ –ø–ª–∞–Ω–∏
  - –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—ñ —Å–ª–æ—Ç—ñ–≤
  - –ó–±—ñ—Ä –∫–æ–Ω—Ç–∞–∫—Ç—ñ–≤ –ª—ñ–¥—ñ–≤
  - Waitlist –¥–ª—è –∑–æ–Ω –ø–æ–∑–∞ –∑–æ–Ω–æ—é –æ–±—Å–ª—É–≥–æ–≤—É–≤–∞–Ω–Ω—è

#### GET `/api/chatbot/slot`
–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –¥–æ—Å—Ç—É–ø–Ω–∏–π —Å–ª–æ—Ç.

---

### üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä (`/api/calendar`)

#### GET `/api/calendar/available-slots?date=<YYYY-MM-DD>`
–û—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø–Ω—ñ —Å–ª–æ—Ç–∏ –Ω–∞ –¥–∞—Ç—É.
- **Response**: `{ available: boolean, capacity: N, booked: N }`

#### GET `/api/calendar/next-available`
–ù–∞—Å—Ç—É–ø–Ω–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –¥–∞—Ç–∞.

---

### üëë –ê–¥–º—ñ–Ω (`/api/admin`)

–í—Å—ñ endpoints –≤–∏–º–∞–≥–∞—é—Ç—å –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞ (email === MAIL_ADMIN).

#### GET `/api/admin/users`
–°–ø–∏—Å–æ–∫ –≤—Å—ñ—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤.

#### GET `/api/admin/bookings`
–í—Å—ñ –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è –∑ —Ñ—ñ–ª—å—Ç—Ä–∞–º–∏.

#### PUT `/api/admin/bookings/:id/status`
–ó–º—ñ–Ω–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è.
- **Body**: `{ status, reason? }`

#### POST `/api/admin/send-promo`
–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –ø—Ä–æ–º–æ email.
- **Body**: `{ segment, template, subject?, preview? }`
- **Segments**: all / not_subscribed / basic / plus / premium / elite

#### GET `/api/admin/stats`
–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏.

---

### üë• –†–µ—Ñ–µ—Ä–∞–ª–∏ (`/api/referrals`)

#### POST `/api/referrals/invite`
–ó–∞–ø—Ä–æ—Å–∏—Ç–∏ –¥—Ä—É–≥–∞.
- **Body**: `{ referredEmail }`
- **Reward**: 10% –∑–Ω–∏–∂–∫–∞ –¥–ª—è –æ–±–æ—Ö —Å—Ç–æ—Ä—ñ–Ω

#### GET `/api/referrals/my`
–ú–æ—ó —Ä–µ—Ñ–µ—Ä–∞–ª–∏.

---

### üí¨ –í—ñ–¥–≥—É–∫–∏ (`/api/feedback`)

#### POST `/api/feedback`
–ó–∞–ª–∏—à–∏—Ç–∏ –≤—ñ–¥–≥—É–∫ –ø—ñ—Å–ª—è –≤—ñ–∑–∏—Ç—É.
- **Body**: `{ bookingId, feedback, rating? }`

---

### üìä –¢—Ä–µ–∫—ñ–Ω–≥ (`/api/track`)

#### POST `/api/track/event`
–¢—Ä–µ–∫—ñ–Ω–≥ –ø–æ–¥—ñ–π –¥–ª—è –∞–Ω–∞–ª—ñ—Ç–∏–∫–∏.
- **Body**: `{ event, userId?, properties? }`

---

## üõ° Middleware

### 1. **auth.js** - JWT –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è
```javascript
// –ü–µ—Ä–µ–≤—ñ—Ä—è—î –Ω–∞—è–≤–Ω—ñ—Å—Ç—å —Ç–∞ –≤–∞–ª—ñ–¥–Ω—ñ—Å—Ç—å JWT —Ç–æ–∫–µ–Ω–∞
// –î–æ–¥–∞—î req.user.id (MongoDB _id) –¥–æ –∑–∞–ø–∏—Ç—É
```
**–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:** –î–æ–¥–∞—î—Ç—å—Å—è –¥–æ –≤—Å—ñ—Ö –∑–∞—Ö–∏—â–µ–Ω–∏—Ö –º–∞—Ä—à—Ä—É—Ç—ñ–≤.

---

### 2. **blacklist.js** - –ß–æ—Ä–Ω–∏–π —Å–ø–∏—Å–æ–∫
```javascript
// –ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ –Ω–µ –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á
ensureNotBlacklisted(req, res, next)
```

---

### 3. **otpRateLimit.js** - Rate Limiting
–û–±–º–µ–∂–µ–Ω–Ω—è –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –∑–∞–ø–∏—Ç—ñ–≤ –Ω–∞ OTP –∫–æ–¥–∏ (–∑–∞—Ö–∏—Å—Ç –≤—ñ–¥ —Å–ø–∞–º—É).

```javascript
// In-memory rate limiter (–¥–ª—è production –∫—Ä–∞—â–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ Redis)
// –õ—ñ–º—ñ—Ç: 3 –∑–∞–ø–∏—Ç–∏ –Ω–∞ —Ö–≤–∏–ª–∏–Ω—É –Ω–∞ IP+email –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—é
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä–∏:**
- **Window**: 60 —Å–µ–∫—É–Ω–¥ (1 —Ö–≤–∏–ª–∏–Ω–∞)
- **Max requests**: 3 –∑–∞–ø–∏—Ç–∏ –Ω–∞ –≤—ñ–∫–Ω–æ
- **Key**: `IP:email` (–∫–æ–º–±—ñ–Ω–∞—Ü—ñ—è)
- **Response**: 429 Too Many Requests –ø—Ä–∏ –ø–µ—Ä–µ–≤–∏—â–µ–Ω–Ω—ñ

**–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:** –ó–∞—Å—Ç–æ—Å–æ–≤—É—î—Ç—å—Å—è –¥–æ `/api/password-reset` POST endpoint.

---

## üß∞ –£—Ç–∏–ª—ñ—Ç–∏

### 1. **emailService.js** - Email –°–µ—Ä–≤—ñ—Å

–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î **AWS SES SMTP** —á–µ—Ä–µ–∑ Nodemailer.

**–û—Å–Ω–æ–≤–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó:**

#### `sendTx(templateId, to, data)`
–í—ñ–¥–ø—Ä–∞–≤–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π–Ω–∏—Ö email –∑ —à–∞–±–ª–æ–Ω–∞–º–∏.

**–î–æ—Å—Ç—É–ø–Ω—ñ —à–∞–±–ª–æ–Ω–∏:**
- `nudge_subscribe` - –ù–∞–≥–∞–¥—É–≤–∞–Ω–Ω—è –ø—Ä–æ –ø—ñ–¥–ø–∏—Å–∫—É
- `nudge_lead_v1` - Follow-up –ª—ñ–¥–∞–º (~2 –≥–æ–¥–∏–Ω–∏)
- `nudge_lead_v2` - Follow-up –ª—ñ–¥–∞–º (~48 –≥–æ–¥–∏–Ω)
- `booking_confirmed` - –ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è
- `booking_reminder` - –ù–∞–≥–∞–¥—É–≤–∞–Ω–Ω—è –ø—Ä–æ –≤—ñ–∑–∏—Ç
- `booking_completed` - –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è –≤—ñ–∑–∏—Ç—É
- `welcome` - –í—ñ—Ç–∞–ª—å–Ω–∏–π –ª–∏—Å—Ç
- `subscription_renewed` - –û–Ω–æ–≤–ª–µ–Ω–Ω—è –ø—ñ–¥–ø–∏—Å–∫–∏
- `subscription_canceled` - –°–∫–∞—Å—É–≤–∞–Ω–Ω—è –ø—ñ–¥–ø–∏—Å–∫–∏
- `password_otp` - 6-–∑–Ω–∞—á–Ω–∏–π OTP –∫–æ–¥ –¥–ª—è –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è
- `password_changed` - –ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –∑–º—ñ–Ω–∏ –ø–∞—Ä–æ–ª—è

#### `sendPromo(template, to, data)`
–í—ñ–¥–ø—Ä–∞–≤–∫–∞ –ø—Ä–æ–º–æ/–º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–∏—Ö –ª–∏—Å—Ç—ñ–≤.

**–°—Ç–∏–ª—ñ–∑–∞—Ü—ñ—è:** –í—Å—ñ email –≤–∫–ª—é—á–∞—é—Ç—å –±—Ä–µ–Ω–¥–æ–≤–∏–π –¥–∏–∑–∞–π–Ω –∑ –ª–æ–≥–æ—Ç–∏–ø–æ–º, –∫–æ–ª—å–æ—Ä–∞–º–∏ (#6f48eb), —Ç–∞ responsive layout.

---

### 2. **s3.js** - AWS S3
```javascript
putPublicObject(key, buffer, contentType)
```
–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –Ω–∞ S3 –∑ –ø—É–±–ª—ñ—á–Ω–∏–º –¥–æ—Å—Ç—É–ø–æ–º.

**Bucket:** `process.env.S3_BUCKET`  
**Prefix:** `uploads/`

---

### 3. **getNextAvailableSlot.js**
```javascript
getNextAvailableSlot(startDate?)
```
–ó–Ω–∞—Ö–æ–¥–∏—Ç—å –Ω–∞—Å—Ç—É–ø–Ω—É –¥–æ—Å—Ç—É–ø–Ω—É –¥–∞—Ç—É –¥–ª—è –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è –∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º capacity —Ç–∞ –≤–∏–º–∫–Ω–µ–Ω–∏—Ö –¥–∞—Ç.

---

## ‚è∞ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è (CRON)

Backend –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `node-cron` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏—Ö –∑–∞–¥–∞—á.

### 1. **Weekly Nudge** (—â–æ—Ç–∏–∂–Ω—è)
**–†–æ–∑–∫–ª–∞–¥:** –ö–æ–∂–µ–Ω –ø–æ–Ω–µ–¥—ñ–ª–æ–∫ –æ 10:00 AM (America/New_York)
```javascript
"0 10 * * 1"
```
**–©–æ —Ä–æ–±–∏—Ç—å:**
- –ó–Ω–∞—Ö–æ–¥–∏—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –±–µ–∑ –∞–∫—Ç–∏–≤–Ω–æ—ó –ø—ñ–¥–ø–∏—Å–∫–∏
- –í—ñ–¥–ø—Ä–∞–≤–ª—è—î `nudge_subscribe` email (–¥–æ 5000 –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤)
- –ü–∞–∫–µ—Ç–Ω–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∞ –ø–æ 10 –ª–∏—Å—Ç—ñ–≤ –∑ –∑–∞—Ç—Ä–∏–º–∫–æ—é 400ms

**–í–∏–º–∫–Ω—É—Ç–∏:** `WEEKLY_NUDGE_ENABLED=false`

---

### 2. **Chatbot Follow-ups** (—â–æ–≥–æ–¥–∏–Ω–∏)
**–†–æ–∑–∫–ª–∞–¥:** –©–æ–≥–æ–¥–∏–Ω–∏ –æ 12-–π —Ö–≤–∏–ª–∏–Ω—ñ
```javascript
"12 * * * *"
```
**–©–æ —Ä–æ–±–∏—Ç—å:**

**Wave 1** (‚âà2 –≥–æ–¥–∏–Ω–∏ –ø—ñ—Å–ª—è –∫–æ–Ω—Ç–∞–∫—Ç—É):
- –ó–Ω–∞—Ö–æ–¥–∏—Ç—å –ª—ñ–¥–∏ –∑—ñ —Å—Ç–∞—Ç—É—Å–æ–º `engaged`
- –Ø–∫—ñ —Å—Ç–≤–æ—Ä–µ–Ω—ñ >2 –≥–æ–¥–∏–Ω–∏ —Ç–æ–º—É
- –©–µ –Ω–µ –æ—Ç—Ä–∏–º–∞–ª–∏ followup1
- –í—ñ–¥–ø—Ä–∞–≤–ª—è—î `nudge_lead_v1`

**Wave 2** (‚âà48 –≥–æ–¥–∏–Ω –ø—ñ—Å–ª—è –∫–æ–Ω—Ç–∞–∫—Ç—É):
- –ó–Ω–∞—Ö–æ–¥–∏—Ç—å –ª—ñ–¥–∏ –ø—ñ—Å–ª—è followup1
- –Ø–∫—ñ —Å—Ç–≤–æ—Ä–µ–Ω—ñ >48 –≥–æ–¥–∏–Ω —Ç–æ–º—É
- –©–µ –Ω–µ –æ—Ç—Ä–∏–º–∞–ª–∏ followup2
- –í—ñ–¥–ø—Ä–∞–≤–ª—è—î `nudge_lead_v2`

**–õ—ñ–º—ñ—Ç:** 500 –ª—ñ–¥—ñ–≤ –Ω–∞ wave  
**Rate:** ~14 emails/sec (70ms delay)  
**–í–∏–º–∫–Ω—É—Ç–∏:** `CHATBOT_FOLLOWUPS_ENABLED=false`

---

## üîó –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó

### 1. **Stripe** (–ø–ª–∞—Ç–µ–∂—ñ)
- Subscription checkout sessions
- Webhook –æ–±—Ä–æ–±–∫–∞ –ø–æ–¥—ñ–π
- –ü—Ä–æ–º–æ –∫–æ–¥–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, FIX10 –¥–ª—è 10% –∑–Ω–∏–∂–∫–∏)
- Trial period: 7 –¥–Ω—ñ–≤

**Env vars:**
- `STRIPE_SECRET_KEY`
- `STRIPE_WEBHOOK_SECRET`

---

### 2. **AWS SES** (email)
- SMTP –¥–ª—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π–Ω–∏—Ö –ª–∏—Å—Ç—ñ–≤
- –®–∞–±–ª–æ–Ω–∏ –∑ HTML + inline CSS
- Rate limiting –¥–ª—è –±–µ–∑–ø–µ–∫–∏

**Env vars:**
- `AWS_SES_SMTP_HOST`
- `AWS_SES_SMTP_USER`
- `AWS_SES_SMTP_PASS`

---

### 3. **AWS S3** (—Ñ–∞–π–ª–∏)
- –ü—É–±–ª—ñ—á–Ω–µ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –∑–æ–±—Ä–∞–∂–µ–Ω—å –¥–æ –±—Ä–æ–Ω—é–≤–∞–Ω—å
- Automatic redirects: `/uploads/*` ‚Üí S3 URL

**Env vars:**
- `S3_BUCKET`
- `S3_PREFIX` (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º: "uploads")
- `AWS_ACCESS_KEY_ID`
- `AWS_SECRET_ACCESS_KEY`
- `AWS_REGION`

---

### 4. **OpenAI** (—á–∞—Ç–±–æ—Ç)
- Model: GPT-4o-mini
- Streaming responses
- Context: Chatbot knowledge base
- Integration –∑ getNextAvailableSlot()

**Env var:**
- `OPENAI_API_KEY`

**Fallback:** –Ø–∫—â–æ –∫–ª—é—á –≤—ñ–¥—Å—É—Ç–Ω—ñ–π, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è stub –≤—ñ–¥–ø–æ–≤—ñ–¥—å.

---

### 5. **Facebook Conversion API** (—Ç—Ä–µ–∫—ñ–Ω–≥)
- –¢—Ä–µ–∫—ñ–Ω–≥ –∫–æ–Ω–≤–µ—Ä—Å—ñ–π –¥–ª—è —Ä–µ–∫–ª–∞–º–∏
- Events: Lead, Subscribe, Purchase

**Controller:** `controllers/facebookCapi.js`

---

## ‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ –∑–º—ñ–Ω–Ω—ñ –æ—Ç–æ—á–µ–Ω–Ω—è

### –û–±–æ–≤'—è–∑–∫–æ–≤—ñ –∑–º—ñ–Ω–Ω—ñ:

```bash
# MongoDB
MONGO_URI=mongodb+srv://...

# JWT —Å–µ–∫—Ä–µ—Ç–∏
JWT_SECRET=your_jwt_secret_here
JWT_RESET_SECRET=your_reset_secret_here

# Stripe
STRIPE_SECRET_KEY=sk_live_...
STRIPE_WEBHOOK_SECRET=whsec_...

# AWS SES (Email)
AWS_SES_SMTP_HOST=email-smtp.us-east-1.amazonaws.com
AWS_SES_SMTP_USER=AKIA...
AWS_SES_SMTP_PASS=...

# AWS S3 (Files)
S3_BUCKET=your-bucket-name
AWS_ACCESS_KEY_ID=AKIA...
AWS_SECRET_ACCESS_KEY=...
AWS_REGION=us-east-1

# OpenAI (Chatbot)
OPENAI_API_KEY=sk-...

# Email –∞–¥—Ä–µ—Å–∏
MAIL_FROM=Mr. Fixter <my@profixter.com>
MAIL_REPLY_TO=getfixter@gmail.com
MAIL_ADMIN=getfixter@gmail.com

# URLs
SITE_URL=https://profixter.com
FRONTEND_URL=https://profixter.com
```

### –û–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ:

```bash
# –ü–æ—Ä—Ç (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º 5000)
PORT=5000

# S3 prefix (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º "uploads")
S3_PREFIX=uploads

# CRON –≤–∏–º–∏–∫–∞—á—ñ
WEEKLY_NUDGE_ENABLED=true
CHATBOT_FOLLOWUPS_ENABLED=true

# Brand URLs
TIP_LINK=https://buy.stripe.com/...
REVIEW_URL=https://maps.app.goo.gl/...
PLANS_URL=https://profixter.com/subscription
SCHEDULE_URL=https://profixter.com/schedule
```

---

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç—É

### Development —Ä–µ–∂–∏–º:
```bash
cd backend
npm install
npm run dev  # nodemon server.js
```

### Production —Ä–µ–∂–∏–º:
```bash
npm start  # node server.js
```

### –ú—ñ–≥—Ä–∞—Ü—ñ–π–Ω—ñ —Å–∫—Ä–∏–ø—Ç–∏:
```bash
npm run migrate:addresses        # –ú—ñ–≥—Ä–∞—Ü—ñ—è –∞–¥—Ä–µ—Å
npm run migrate:subs-addr        # Backfill –ø—ñ–¥–ø–∏—Å–æ–∫ –∑ –∞–¥—Ä–µ—Å–∞–º–∏
npm run audit:subs              # –ê—É–¥–∏—Ç –ø—ñ–¥–ø–∏—Å–æ–∫ (dry run)
npm run fix:subs                # –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø—ñ–¥–ø–∏—Å–æ–∫
```

---

## üì° CORS –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

–î–æ–∑–≤–æ–ª–µ–Ω—ñ origins:
```javascript
[
  "http://localhost:3000",
  "http://handyman-frontend-v1.s3-website-us-east-1.amazonaws.com",
  "http://handyman-v2-env.eba-fq3ppgr4.us-east-1.elasticbeanstalk.com",
  "http://profixter.com",
  "https://profixter.com",
  "http://www.profixter.com",
  "https://www.profixter.com",
]
```

**Credentials:** `true`  
**Methods:** `GET, POST, PUT, DELETE`  
**Headers:** `Authorization, Content-Type`

---

## üìä –°—Ç–∞—Ç—É—Å —Ç–∞ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥

### Health checks:
- MongoDB connection –∑ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—î—é —ñ–Ω–¥–µ–∫—Å—ñ–≤
- JWT secrets –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –ø—Ä–∏ —Å—Ç–∞—Ä—Ç—ñ
- Test query –Ω–∞ User –∫–æ–ª–µ–∫—Ü—ñ—é

### –õ–æ–≥—É–≤–∞–Ω–Ω—è:
```
‚úÖ MongoDB Connected
‚úÖ User indexes in sync
‚úÖ MongoDB Test Passed
‚úÖ JWT_RESET_SECRET present
üöÄ Server running on port 5000
```

---

## üîí –ë–µ–∑–ø–µ–∫–∞

1. **–ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è:** JWT —Ç–æ–∫–µ–Ω–∏ (httpOnly cookies + Bearer token)
2. **–ü–∞—Ä–æ–ª—ñ:** bcryptjs hashing (salt rounds: 10)
3. **Rate Limiting:** OTP requests
4. **Blacklist:** Middleware –¥–ª—è –±–ª–æ–∫—É–≤–∞–Ω–Ω—è –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫—ñ–≤
5. **CORS:** –û–±–º–µ–∂–µ–Ω—ñ origins
6. **Webhook verification:** Stripe signature –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞
7. **Input sanitization:** Mongoose —Å—Ö–µ–º–∏ + validation

---

## üìù –ü—Ä–∏–º—ñ—Ç–∫–∏ –¥–ª—è —Ä–æ–∑—Ä–æ–±–Ω–∏–∫—ñ–≤

### –ú–Ω–æ–∂–∏–Ω–Ω—ñ –∞–¥—Ä–µ—Å–∏:
–ü—Ä–æ–µ–∫—Ç –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –≤—ñ–¥ single address (legacy) –¥–æ multiple addresses per user:
- `User.addresses` - –º–∞—Å–∏–≤ –∞–¥—Ä–µ—Å
- `User.defaultAddressId` - –∞–¥—Ä–µ—Å–∞ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º
- `Subscription.addressId` - –ø—ñ–¥–ø–∏—Å–∫–∞ –ø—Ä–∏–≤'—è–∑–∞–Ω–∞ –¥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ—ó –∞–¥—Ä–µ—Å–∏
- `Booking.addressId` - –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ—ó –∞–¥—Ä–µ—Å–∏

### –ú—ñ–≥—Ä–∞—Ü—ñ—è:
–Ñ —Å–∫—Ä–∏–ø—Ç–∏ –¥–ª—è –º—ñ–≥—Ä–∞—Ü—ñ—ó legacy –¥–∞–Ω–∏—Ö. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –∑ –æ–¥–Ω–æ—é –∞–¥—Ä–µ—Å–æ—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –º—ñ–≥—Ä—É—é—Ç—å—Å—è –ø—Ä–∏ –ª–æ–≥—ñ–Ω—ñ/–ø—Ä–æ—Ñ—ñ–ª—ñ –∑–∞–ø–∏—Ç–∞—Ö.

### Timezone:
–í—Å—ñ CRON –∑–∞–¥–∞—á—ñ —Ç–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å `America/New_York` timezone.

### Capacity management:
- `CalendarConfig` - –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è capacity per day
- `SlotCounter` - –ª—ñ—á–∏–ª—å–Ω–∏–∫ –∑–∞–π–Ω—è—Ç–∏—Ö —Å–ª–æ—Ç—ñ–≤
- –í–∞–ª—ñ–¥–∞—Ü—ñ—è –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è

### Email templates:
–í—Å—ñ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π–Ω—ñ email –≤–∫–ª—é—á–∞—é—Ç—å:
- Responsive HTML design
- Brand colors —Ç–∞ –ª–æ–≥–æ—Ç–∏–ø
- CTAs –∑ tracking
- Unsubscribe links –¥–ª—è –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–∏—Ö –ª–∏—Å—Ç—ñ–≤

---

## üé® –ë—Ä–µ–Ω–¥–∏–Ω–≥

**–ù–∞–∑–≤–∞:** Mr. Fixter / Profixter  
**–ö–æ–ª—ñ—Ä:** `#6f48eb` (—Ñ—ñ–æ–ª–µ—Ç–æ–≤–∏–π)  
**–õ–æ–≥–æ—Ç–∏–ø:** `mrfixter-logoBlackText.png` (S3)  
**–î–æ–º–µ–Ω:** profixter.com  
**–ó–æ–Ω–∞ –æ–±—Å–ª—É–≥–æ–≤—É–≤–∞–Ω–Ω—è:** Nassau County, Suffolk County, NY  

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç–∏ —Ç–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞

**Email:** getfixter@gmail.com  
**Phone:** +1 (631) 599-1363  
**Website:** https://profixter.com  
**Google Reviews:** https://maps.app.goo.gl/65L1i4GGsd1nMWEi7

---

## üìÑ –õ—ñ—Ü–µ–Ω–∑—ñ—è

–ü—Ä–æ–ø—Ä–∏—î—Ç–∞—Ä–Ω–µ –ü–ó. –í—Å—ñ –ø—Ä–∞–≤–∞ –∑–∞—Ö–∏—â–µ–Ω—ñ.

---

**–î–∞—Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó:** 19 –ª–∏—Å—Ç–æ–ø–∞–¥–∞ 2025 —Ä.  
**–í–µ—Ä—Å—ñ—è:** 1.0.0  
**–ê–≤—Ç–æ—Ä:** Backend Documentation Generator

---

_–¶—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è –æ—Ö–æ–ø–ª—é—î –ø–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞–Ω backend –¥–æ–¥–∞—Ç–∫—É. –î–ª—è –∑–º—ñ–Ω –∞–±–æ –¥–æ–ø–æ–≤–Ω–µ–Ω—å –∑–≤–µ—Ä–Ω—ñ—Ç—å—Å—è –¥–æ —Ä–æ–∑—Ä–æ–±–Ω–∏–∫—ñ–≤._
